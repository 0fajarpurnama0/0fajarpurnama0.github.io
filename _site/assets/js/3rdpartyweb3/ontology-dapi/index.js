module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t){e.exports=require("@ont-community/window-post-message-proxy")},function(e,t){e.exports=require("crypto-js")},function(e,t){e.exports=require("webextension-polyfill-ts")},function(e,t){e.exports=require("promise-timeout")},function(e,t){e.exports=require("base-x")},function(e,t){e.exports=require("typedarray-to-buffer")},function(e,t,r){"use strict";r.r(t),r.d(t,"ExtensionType",(function(){return H})),r.d(t,"TransactionType",(function(){return x})),r.d(t,"VmType",(function(){return B})),r.d(t,"client",(function(){return n})),r.d(t,"provider",(function(){return s})),r.d(t,"Tunnel",(function(){return T})),r.d(t,"Rpc",(function(){return O})),r.d(t,"utilsApi",(function(){return y}));var n={};r.r(n),r.d(n,"api",(function(){return S})),r.d(n,"registerClient",(function(){return E}));var s={};r.r(s),r.d(s,"registerContentProxy",(function(){return R})),r.d(s,"registerProvider",(function(){return U}));var o=r(0);class a{constructor(e){this.rpc=e}stakePeers(e){return this.rpc.call("governance.stakePeers",e)}redeemPeers(e){return this.rpc.call("governance.redeemPeers",e)}withdrawFeeReward(e){return this.rpc.call("governance.withdrawFeeReward",e)}withdrawUnfrozenOnt(e){return this.rpc.call("governance.withdrawUnfrozenOnt",e)}withdrawPeerUnboundOng(e){return this.rpc.call("governance.withdrawPeerUnboundOng",e)}getAllPeerPool(){return this.rpc.call("governance.getAllPeerPool")}getAttributes(e){return this.rpc.call("governance.getAttributes",e)}getStakeInfo(e){return this.rpc.call("governance.getStakeInfo",e)}getRewardFeeAmount(){return this.rpc.call("governance.getRewardFeeAmount")}}class i{constructor(e){this.rpc=e}getAccount(){return this.rpc.call("asset.getAccount")}getPublicKey(){return this.rpc.call("asset.getPublicKey")}send(e){return this.rpc.call("asset.send",e)}sendV2(e){return this.rpc.call("asset.sendV2",e)}}class c{constructor(e){this.rpc=e}getIdentity(){return this.rpc.call("identity.getIdentity")}getDDO(e){return this.rpc.call("identity.getDDO",e)}addAttributes(e){return this.rpc.call("identity.addAttributes",e)}removeAttribute(e){return this.rpc.call("identity.removeAttribute",e)}addCredential(e){return this.rpc.call("identity.addCredential",e)}getCredentials(){return this.rpc.call("identity.getCredentials")}}class g{constructor(e){this.rpc=e}signMessageHash(e){return this.rpc.call("message.signMessageHash",e)}verifyMessageHash(e){return this.rpc.call("message.verifyMessageHash",e)}signMessage(e){return this.rpc.call("message.signMessage",e)}verifyMessage(e){return this.rpc.call("message.verifyMessage",e)}}class l{constructor(e){this.rpc=e}getNodeCount(){return this.rpc.call("network.getNodeCount")}getBlockHeight(){return this.rpc.call("network.getBlockHeight")}getMerkleProof(e){return this.rpc.call("network.getMerkleProof",e)}getStorage(e){return this.rpc.call("network.getStorage",e)}getAllowance(e){return this.rpc.call("network.getAllowance",e)}getAllowanceV2(e){return this.rpc.call("network.getAllowanceV2",e)}getBlock(e){return this.rpc.call("network.getBlock",e)}getTransaction(e){return this.rpc.call("network.getTransaction",e)}getNetwork(){return this.rpc.call("network.getNetwork")}getBalance(e){return this.rpc.call("network.getBalance",e)}getBalanceV2(e){return this.rpc.call("network.getBalanceV2",e)}isConnected(){return this.rpc.call("network.isConnected")}getUnboundOng(e){return this.rpc.call("network.getUnboundOng",e)}getContract(e){return this.rpc.call("network.getContract",e)}getSmartCodeEvent(e){return this.rpc.call("network.getSmartCodeEvent",e)}getBlockHeightByTxHash(e){return this.rpc.call("network.getBlockHeightByTxHash",e)}getBlockHash(e){return this.rpc.call("network.getBlockHash",e)}getBlockTxsByHeight(e){return this.rpc.call("network.getBlockTxsByHeight",e)}getGasPrice(){return this.rpc.call("network.getGasPrice")}getGrantOng(e){return this.rpc.call("network.getGrantOng",e)}getMempoolTxCount(){return this.rpc.call("network.getMempoolTxCount")}getMempoolTxState(e){return this.rpc.call("network.getMempoolTxState",e)}getVersion(){return this.rpc.call("network.getVersion")}}var d=r(3);class u{constructor(e){this.rpc=e}getProvider(){return Object(d.timeout)(this.rpc.call("provider.getProvider"),1e3).catch(()=>Promise.reject("NO_PROVIDER"))}}class h{constructor(e){this.rpc=e}invoke(e){return this.rpc.call("smartContract.invoke",e)}invokeRead(e){return this.rpc.call("smartContract.invokeRead",e)}deploy(e){return this.rpc.call("smartContract.deploy",e)}invokeWasm(e){return this.rpc.call("smartContract.invokeWasm",e)}invokeWasmRead(e){return this.rpc.call("smartContract.invokeWasmRead",e)}}class p{constructor(e){this.rpc=e}login(){return this.rpc.call("stateChannel.login")}sign(e){return this.rpc.call("stateChannel.sign",e)}}var w=r(4),k=r(1);const m=r(5),f=w("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),y={strToHex:e=>b(function(e){const t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0,n=e.length;t<n;t++)r[t]=e.charCodeAt(t);return t}(e)),hexToStr(e){return t=P(e),String.fromCharCode.apply(null,Array.from(new Uint8Array(t)));var t},addressToHex:e=>v(e),hexToAddress:e=>M(e),isAddress(e){try{return v(e),!0}catch(e){return!1}}};function v(e){const t=b(f.decode(e)).substr(2,40);if(e!==M(t))throw new Error("[addressToU160] decode encoded verify failed");return t}function M(e){const t="17"+e,r=C(t),n=C(r).slice(0,8),s=m(new Uint8Array(P(t+n)));return f.encode(s)}function C(e){const t=k.enc.Hex.parse(e);return k.SHA256(t).toString()}function P(e){const t=[];for(;e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t}function b(e){let t="";const r=new Uint8Array(e);for(let e=0;e<r.byteLength;e++){let n=r[e].toString(16);n=0===n.length?"00":1===n.length?"0"+n:n,t+=n}return t}class A{constructor(e){this.utils=y,this.asset=new i(e),this.identity=new c(e),this.message=new g(e),this.network=new l(e),this.provider=new u(e),this.smartContract=new h(e),this.stateChannel=new p(e),this.governance=new a(e)}}var H,x,B;!function(e){e.Cyano="cyano",e.Onto="onto"}(H||(H={})),function(e){e[e.BookKeeper=2]="BookKeeper",e[e.Claim=3]="Claim",e[e.Deploy=208]="Deploy",e[e.Invoke=209]="Invoke",e[e.Enrollment=4]="Enrollment",e[e.Vote=5]="Vote"}(x||(x={})),function(e){e[e.NEOVM_TYPE=1]="NEOVM_TYPE",e[e.WASMVM_TYPE=3]="WASMVM_TYPE"}(B||(B={}));class T{constructor(e){if(this.source=e.source,this.destination=e.destination,this.postMessage=e.postMessage,this.messageHandler=e.messageHandler,this.logMessages=e.logMessages,void 0===e.addListener&&void 0===e.postMessage)throw new Error("Either addListener or postMessage must be present.");if(void 0!==e.addListener){if(void 0===e.messageHandler)throw new Error("MessageHandler must be specified if addListener present.");e.addListener(this.onMessage.bind(this))}}async send(e){const t={destination:this.destination,payload:e,source:this.source,type:"dAPI.js"};if(void 0===this.postMessage)throw new Error("PostMessage was not specified.");this.logMessages&&console.warn(`Tunnel: (${this.source}): Sending`,JSON.stringify(e,null,"  "));const r=await this.postMessage(t);if(void 0!==r.error)throw new Error(r.error);return r.payload}onMessage(e,t){if(e.destination===this.source&&e.source===this.destination){let r;try{if(void 0===this.messageHandler)throw new Error("MessageHandler was not specified.");this.logMessages&&console.warn(`Tunnel: (${this.source}): Receiving`,JSON.stringify(e.payload,null,"  "));const n={id:t.id,url:t.url},s=this.messageHandler(e.payload,n);r=Promise.resolve(s)}catch(e){r=Promise.reject(e)}return r.then(t=>({destination:e.source,payload:t,source:e.destination,type:"dAPI.js"})).catch(t=>({destination:e.source,error:t,source:e.destination,type:"dAPI.js"}))}}}class O{constructor(e){e.messageHandler=this.messageHandler.bind(this),this.tunnel=new T(e),this.methods=new Map}call(e,...t){const r={method:e,params:t};return this.tunnel.send(r)}register(e,t){this.methods.set(e,t)}messageHandler(e,t){const r=this.methods.get(e.method);if(void 0===r)throw new Error("Unregistered method call: "+e.method);return r.call(t,...e.params)}}let S,V;function E({logMessages:e=!1,logWarnings:t=!1,extension:r=H.Cyano}){const n=new o.WindowPostMessageProxy({name:"page",target:r===H.Cyano?"content-script":"content-script-"+r,logMessages:e,suppressWarnings:!t}),s=new O({source:"page",destination:"background",logMessages:!1,postMessage:e=>n.postMessage(window,e)});return S=new A(s),S}function R({logMessages:e=!1,logWarnings:t=!1,extension:n=H.Cyano}){const{browser:s}=r(2);new o.WindowPostMessageProxy({logMessages:e,suppressWarnings:!t,name:n===H.Cyano?"content-script":"content-script-"+n,target:"page"}).addHandler({handle:e=>s.runtime.sendMessage(e),test:e=>"dAPI.js"===e.type&&"page"===e.source})}function U({provider:e,logMessages:t}){const{browser:n}=r(2);function s(e,t){if(void 0===t)throw new Error("DApi provider does not implement "+e);V.register(e,t)}V=new O({source:"background",destination:"page",logMessages:t,addListener:n.runtime.onMessage.addListener}),s("asset.getAccount",e.asset.getAccount),s("asset.getPublicKey",e.asset.getPublicKey),s("asset.send",e.asset.send),s("asset.sendV2",e.asset.sendV2),s("identity.getIdentity",e.identity.getIdentity),s("identity.getDDO",e.identity.getDDO),s("identity.addAttributes",e.identity.addAttributes),s("identity.removeAttribute",e.identity.removeAttribute),s("identity.addCredential",e.identity.addCredential),s("identity.getCredentials",e.identity.getCredentials),s("message.signMessage",e.message.signMessage),s("message.verifyMessage",e.message.verifyMessage),s("message.signMessageHash",e.message.signMessageHash),s("message.verifyMessageHash",e.message.verifyMessageHash),s("network.getAllowance",e.network.getAllowance),s("network.getAllowanceV2",e.network.getAllowanceV2),s("network.getBalance",e.network.getBalance),s("network.getBalanceV2",e.network.getBalanceV2),s("network.getBlock",e.network.getBlock),s("network.getBlockHeight",e.network.getBlockHeight),s("network.getMerkleProof",e.network.getMerkleProof),s("network.getNetwork",e.network.getNetwork),s("network.getNodeCount",e.network.getNodeCount),s("network.getStorage",e.network.getStorage),s("network.getTransaction",e.network.getTransaction),s("network.isConnected",e.network.isConnected),s("network.getUnboundOng",e.network.getUnboundOng),s("network.getContract",e.network.getContract),s("network.getSmartCodeEvent",e.network.getSmartCodeEvent),s("network.getBlockHeightByTxHash",e.network.getBlockHeightByTxHash),s("network.getBlockHash",e.network.getBlockHash),s("network.getBlockTxsByHeight",e.network.getBlockTxsByHeight),s("network.getGasPrice",e.network.getGasPrice),s("network.getGrantOng",e.network.getGrantOng),s("network.getMempoolTxCount",e.network.getMempoolTxCount),s("network.getMempoolTxState",e.network.getMempoolTxState),s("network.getVersion",e.network.getVersion),s("smartContract.invoke",e.smartContract.invoke),s("smartContract.invokeRead",e.smartContract.invokeRead),s("smartContract.deploy",e.smartContract.deploy),s("smartContract.invokeWasm",e.smartContract.invokeWasm),s("smartContract.invokeWasmRead",e.smartContract.invokeWasmRead),s("provider.getProvider",e.provider.getProvider),s("stateChannel.login",e.stateChannel.login),s("stateChannel.sign",e.stateChannel.sign),s("governance.stakePeers",e.governance.stakePeers),s("governance.redeemPeers",e.governance.redeemPeers),s("governance.withdrawFeeReward",e.governance.withdrawFeeReward),s("governance.withdrawUnfrozenOnt",e.governance.withdrawUnfrozenOnt),s("governance.withdrawPeerUnboundOng",e.governance.withdrawPeerUnboundOng),s("governance.getAllPeerPool",e.governance.getAllPeerPool),s("governance.getAttributes",e.governance.getAttributes),s("governance.getStakeInfo",e.governance.getStakeInfo),s("governance.getRewardFeeAmount",e.governance.getRewardFeeAmount)}}]);
//# sourceMappingURL=index.js.map