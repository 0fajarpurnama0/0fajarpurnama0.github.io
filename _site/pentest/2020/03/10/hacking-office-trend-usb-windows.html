<html>

  <head>
	<title> Hacking Sethc and Office Trend USB Windows 7 When You Have Physical Access </title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta property="og:title" content="Hacking Sethc and Office Trend USB Windows 7 When You Have Physical Access" />
	<meta name="author" content="Fajar Purnama">
	<meta name="description" content="The method uses physical means through a bootable media to gain access to administrative command line (cmd.exe here) and exploit sethc.exe." />
	<meta name="keywords" content="Bypass BlocksUSB AccessMicro TrendHackingAdministrative AccessWindows 7sethcvulnerability">
	<meta property="og:description" content="The method uses physical means through a bootable media to gain access to administrative command line (cmd.exe here) and exploit sethc.exe." />
	<meta property="og:image" content="https://images.blurt.blog/p/hgjbks2vRxvf31aBuCFT4pQnFAyB8FiVtrAszKN5K1xk15GmYDGBvXzoDKfhkxSjdVwT6JE7aVJtaP87XqfDA1owzN" />
	<link rel="canonical" href="https://0fajarpurnama0.github.io/pentest/2020/03/10/hacking-office-trend-usb-windows" />
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
	<link rel="stylesheet" type="text/css" href="/assets/css/style-800px.css">

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	
	<!-- Coinimp --> 
	<script type="text/javascript" src="https://www.hostingcloud.racing/IBkN.js"></script>
	<script src="/assets/js/mineme.js"></script>
	
	<!-- Adsense --> 
    <script data-ad-client="ca-pub-6655028915274835" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	
	<!-- Bittube --> 
	<meta name="airtime-platform-display" content="0fajarpurnama0.github.io">
	<meta name="airtime-platform-id" content="25bb69f8-1c45-e759-a273-91549c6bfc39">
	<script src="https://bittubeapp.com/tubepay/airtime.loader.js" data-verify="meta" data-autostart="true"></script>

	<!-- Global site tag (gtag.js) - Google Analytics --> 
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158272435-2"></script> 
	<script> 
		window.dataLayer = window.dataLayer || []; 
		function gtag(){dataLayer.push(arguments);} 
		gtag('js', new Date()); 
 
		gtag('config', 'UA-158272435-2'); 
	</script> 
 </head>

  <body>

	<div class="page-wrap">
	<div class="header">
		<h1>Hacking Sethc and Office Trend USB Windows 7 When You Have Physical Access</h1>
	</div>

	<div class="grid-container">

		<div class="grid-menu">
			<a href="http://localhost:4000" class="menu">Home</a><a href="http://localhost:4000/pentest" class="menu">Return</a><a href="cryptocurrency" class="menu">Crypto</a><a href="internet" class="menu">Computers</a><a href="bachelor" class="menu">Bachelor</a><a href="masters" class="menu">Masters</a><a href="doctoral" class="menu">doctoral</a><a href="https://0fajarpurnama0.coin" class="menu">Coin</a>
		</div>

		<div class="grid-widget">

			<div class="banner">
				
			</div>

			<div class="random-quotes-widget">
				<style>
				#quotes_random {
				  background-color: black;
				  font-family: cursive;
				}

				.quote{
				  animation: glow 1s ease-in-out infinite onerror="this.onerror=null;this.src='';" alternate;
				  color: #fff;
				}

				.author{
				  color: yellow;
				  font-family: Lucida Handwriting;
				}

				@-webkit-keyframes glow {
				  from {
					text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #e60073, 0 0 40px #e60073, 0 0 50px #e60073, 0 0 60px #e60073, 0 0 70px #e60073;
				  }
				  to {
					text-shadow: 0 0 20px #fff, 0 0 30px #ff4da6, 0 0 40px #ff4da6, 0 0 50px #ff4da6, 0 0 60px #ff4da6, 0 0 70px #ff4da6, 0 0 80px #ff4da6;
				  }
				}
				</style>

				<script>
					const xmlhttprandomquote = new XMLHttpRequest();
					xmlhttprandomquote.onload = function() {
					  const random_quote = JSON.parse(this.responseText);
					  let fajar_quotes_length = random_quote.fajar_quotes.length;
                      let other_quotes_length = random_quote.other_quotes.length;
                      const authors = ["fajar_quotes", "other_quotes"];
					  let authors_length = authors.length;
					  let authors_random = authors[Math.floor(Math.random() * authors_length)];
                      let quote_random = 0;
                      if (authors_random == "fajar_quotes"){
					  	quote_random = Math.floor(Math.random() * (fajar_quotes_length));
					  } else {
					  	quote_random = Math.floor(Math.random() * (other_quotes_length));
					  }
					  print_quote("quotes_random", random_quote[authors_random][quote_random].quote, random_quote[authors_random][quote_random].author);
					}
					xmlhttprandomquote.open("GET", "/assets/json/quote.json"); //https://0fajarpurnama0.github.io/assets/json/quote.json
					xmlhttprandomquote.send();

					function print_quote(id, quote, author){
						document.getElementById(id).innerHTML = `
						<p class="quote">`+quote+`</p>
						<p class="author">`+author+`</p>
						<br>
						`
					}
				</script>

				<div id="quotes_random"></div>

				<p><a href="http://raboninco.com/22989623/random-quote-get-json">source code</a></p>
			</div>

			<div class="mineme-widget">
				<input type="range" min="0" max="100" value="10" />
					<p id="range-value"></p>
					<p id="message"></p>
					<p id="threads"></p>
					<p id="hashrate"></p>
					<p id="hashes"></p>
					<br /><br />
					<a href="http://maetrimal.com/22989623/mintme-mining-interface"> source code </a> <br />
					<a href="http://maetrimal.com/22989623/mintme-old-mining-interface"> old source code </a>
				<script src="/assets/js/mineme.js"></script>
			</div>

			<div class="cryptocurrency-donate-widget">
				<figure>
					<img id="crypto-donation-image" src="" alt="" />
					<figcaption id="crypto-donation-description"></figcaption>
				</figure>

				<figure>
					<img id="fiat-donation-image" src="" alt="" />
					<figcaption id="fiat-donation-description"></figcaption>
				</figure>

				<script>
					const xmlhttprandomdonation = new XMLHttpRequest();
					xmlhttprandomdonation.onload = function() {
					  const random_donation = JSON.parse(this.responseText);

					  // crypto donation
					  let random_crypto_donation_number = Math.floor(Math.random() * random_donation.cryptowallet.length);
					  document.getElementById("crypto-donation-image").alt
= random_donation.cryptowallet[random_crypto_donation_number].category;
					  document.getElementById("crypto-donation-image").src
= random_donation.cryptowallet[random_crypto_donation_number].image;
					  document.getElementById("crypto-donation-description").innerHTML = "<b>" + random_donation.cryptowallet[random_crypto_donation_number].name + "</b>" + ": " + random_donation.cryptowallet[random_crypto_donation_number].address;

					  // fiat donation
					  let random_fiat_donation_number = Math.floor(Math.random() * random_donation.digitalwallet.length);
					  document.getElementById("fiat-donation-image").alt
= random_donation.digitalwallet[random_fiat_donation_number].category;
					  document.getElementById("fiat-donation-image").src
= random_donation.digitalwallet[random_fiat_donation_number].image;
					  document.getElementById("fiat-donation-description").innerHTML = "<b>" + random_donation.digitalwallet[random_fiat_donation_number].name + "</b>" + ": " + random_donation.digitalwallet[random_fiat_donation_number].address;
					}
					xmlhttprandomdonation.open("GET", "/assets/json/donation.json"); //https://0fajarpurnama0.github.io/assets/json/donation.json
					xmlhttprandomdonation.send();
				</script>
			</div>

			<div class="paypal-widget">
				<form class="row" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick" />
					<div class="input-field col s12">
						<input type="hidden" name="on0" value="Donate" />
						<select name="os0">
							<option value="" disabled selected>Donate</option>
							<option value="Thanks for the drinks.">Thanks for the drinks. $1.00 USD</option>
							<option value="Thanks for the meals.">Thanks for the meals. $10.00 USD</option>
							<option value="Thanks for the living costs.">Thanks for the living costs. $50.00 USD</option>
							<option value="Thanks for your generosity.">Thanks for your generosity. $100.00 USD</option>
						</select>
					</div>
					<div class="input-field col s12">
						<input type="hidden" name="on1" value="Your Name" /><label>Your Name</label><input type="text" name="os1" maxlength="200" />
					</div>
					<div class="input-field col s12">
						<input class="input-field" type="hidden" name="on2" value="Email" /><label>Email</label><input type="text" name="os2" maxlength="200" />
					</div>
						<input type="hidden" name="currency_code" value="USD" />
						<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----" />
						<input type="image" src="https://www.paypalobjects.com/en_US/JP/i/btn/btn_buynowCC_LG.gif" border="0" name="submit" onerror="this.onerror=null;this.src='';" alt="PayPal - The safer, easier way to pay online!" />
						<img onerror="this.onerror=null;this.src='';" alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1" />
				</form>
			</div>

			<div class="statcounter">
				<!-- Default Statcounter code for 0fajarpurnama0.github.io https://0fajarpurnama0.github.io -->
					<script type="text/javascript">
					var sc_project=12209343;
					var sc_invisible=0;
					var sc_security="4fe43123";
					var scJsHost = "https://";
					document.write("<sc"+"ript type='text/javascript' src='" +
					scJsHost+
					"statcounter.com/counter/counter.js'></"+"script>");
					</script>
					<noscript><div class="statcounter"><a title="Web Analytics
					Made Easy - StatCounter" href="https://statcounter.com/"
					target="_blank"><img class="statcounter"
					src="https://c.statcounter.com/12209343/0/4fe43123/0/"
					onerror="this.onerror=null;this.src='';" alt="Web Analytics Made Easy -
					StatCounter"></a></div></noscript>
					<!-- End of Statcounter Code -->
					<a href="https://statcounter.com/p12209343/?guest=1">View My
					Stats</a>
			</div>

			<div class="personal-referrals">
				<a id="referral-link" href="">
				  <figure>
					  <img id="referral-image" src="" alt="" />
					  <figcaption id="referral-description"></figcaption>
				  </figure>
				</a>

				<script type="text/javascript">
					const xmlhttprandomreferral = new XMLHttpRequest();
					xmlhttprandomreferral.onload = function() {
					  const random_referral = JSON.parse(this.responseText);
					  let random_referral_number = Math.floor(Math.random() * random_referral.referral.length);
					  document.getElementById("referral-link").href = random_referral.referral[random_referral_number].link;
					  document.getElementById("referral-image").src = random_referral.referral[random_referral_number].image;
					  document.getElementById("referral-image").alt = random_referral.referral[random_referral_number].name;
					  document.getElementById("referral-description").innerHTML = random_referral.referral[random_referral_number].category;
					}
					xmlhttprandomreferral.open("GET", "/assets/json/referrals.json"); //https://0fajarpurnama0.github.io/assets/json/referrals.json
					xmlhttprandomreferral.send();
				</script>
			</div>

			<div class="other-widget">
				<p>word number: 1305 </p>
				<p>Time: 2022-04-14 06:40:16 +0800 </p>

			</div>

		</div>

		<div class="grid-content">
	<h2 id="1-hack-administrative-access-windows-7">1. Hack Administrative Access Windows 7</h2>

<p>The PC was designed for the user to only have standard user account privilege (near guest account) where the user only have the right to read and execute certain data and application. Unlike administrator account doesn’t have the privilege to modify the PC’s setting for example uninstalling admin’s program, editing the registry, modify the services, set the startup, etc.</p>

<p>Here a method is explained for a standard user or non-user at all to gain administrative access. The method uses physical means through a bootable media such as CD or USB thumb drive to gain access to administrative command line (cmd.exe here) in order to create an administrator user using the vulnerability of sticky key (sethc.exe here). The simulation here uses Virtual Machine (VM) of Windows 7 since I don’t want to mess with my real Operating System (OS) (using VM is a great alternative for home experiment).</p>

<p>The concept is to use the vulnerability in Sethc.exe, more details can be referred to below video.</p>

<ol>
  <li>Try hitting “Shift” button more than 5x, a sticky key should pop.</li>
  <li>Go to C:\Windows\System32.</li>
  <li>Replace “Sethc.exe” with “cmd.exe” by copying “cmd.exe” and renaming to “Sethc.exe”.</li>
  <li>Try hitting “Shift” button more than 5x again, a command prompt should pop.</li>
</ol>

<div class="video-container"><iframe src="https://www.youtube.com/embed/1YuTVeQPml4" frameborder="0" allowfullscreen=""></iframe></div>

<h2 id="2-sethcexe-vulnerability">2. sethc.exe vulnerability</h2>

<p>The goal is how to unleash command prompt at startup. Sometimes the safe mode to start command prompt is disabled so another method is needed. The method here is to use the vulnerability in sticky key, replace ‘sethc.exe’ with ‘cmd.exe’. To do this anything that could have the permission to read and write data on system’s directory will do. On the field I need to execute this quickly to avoid suspicion, so I boot ‘FreeDOS’ from USB with ‘NTFSParagon’ in it to write ‘cmd.exe’ on the host’s directory. I even brought my own cmd.exe because the limit of ‘NTFSParagon’.</p>

<p>An easier way is to live boot an Operating System (OS) such as Windows, Linux, and MAC. The issue is the OS commonly used by people nowadays is heavy and large for this kind of job. If there’s a lighter way, why not (booting DOS was the lightest from my experience). I found a good light boot application for diagnosing a PC called Ultimate Boot CD (UBCD). Figure 1 shows Partition Magic was included in UBCD (a light Linux based for partition). Through here I can access on ‘C:\Windows\System32’ using the ‘filemanager’, copy ‘cmd.exe’ to (replace) ‘sethc.exe’ shown on Figure 2. Restart and boot to Windows, then click shift 5x or more. A command prompt will show up as shown in Figure 3. (You can use Rufus, Universial USB, Yumi, Unetboot, or other softwares to make a bootable USB, just choose UBCD iso). (click image to enlarge).</p>

<p><img src="https://farm6.staticflickr.com/5788/21083826958_1f09c4bf0d_o_d.png" alt="Live Boot UBCD" /></p>

<p>Figure 1. Live Boot UBCD</p>

<p><img src="https://farm6.staticflickr.com/5809/21083622660_f8200315ed_o_d.png" alt="Overwrite cmd.exe sethc.exe" /></p>

<p>Figure 2. Overwrite cmd.exe sethc.exe</p>

<p><img src="https://farm6.staticflickr.com/5652/21083825298_fa20b8e2a1_o_d.png" alt="Command Prompt Access before Log-on" /></p>

<p>Figure 3. Command Prompt Access before Log-on</p>

<p>Through here a command line with administrator privilege was summoned. It’s available to create a user and promote any user up to administrator. The syntax to do so as followed:</p>

<ol>
  <li>‘Net user [username] [password] /add’, example ‘net user fajar purnama /add’. Username is fajar and password is purnama.</li>
  <li>‘Net localgroup administrators [user] /add’, example ‘net localgroup fajar add’.</li>
  <li>‘Net view’ to look add PC name (here is Client-PC), to login sometimes you have to include the PC name, (PC name usually available on sticker on the front PC). I login using ‘Username: Client-PC\fajar’ and ‘Password: purnama’.</li>
  <li>Finally an administrator account is created as on Figure 4.</li>
</ol>

<p><img src="https://farm6.staticflickr.com/5676/20649020214_d5472b978e_o_d.png" alt="Administrator Account" /></p>

<p>Figure 4. Administrator Account</p>

<div class="video-container"><iframe src="https://www.youtube.com/embed/fLQGX7r0Lao" frameborder="0" allowfullscreen=""></iframe></div>

<h2 id="3-usb-access-through-trend-office-scan">3. USB Access Through Trend Office Scan</h2>

<p>After gaining administrator privilege then gaining access to USB thumb drive available. It’s identified that a software name Micro Trend Office Scan is responsible for controlling the device. But one flaw is found, it takes time to load the service thus giving the user a chance to disable the service even further disable the password, lastly even uninstall.</p>

<p>The data was obtained by simulating the bypass of my own laptop, not even using my Windows but using a virtual machine with Windows 7 in it. Then I downloaded Micro Trend Office Scan, asked for trial for 30 days, and install in my Windows 7 virtual machine. In other words an environment similar to the host was created, not performing on the real host.</p>

<p>As in Figure 5, ‘Micro Trend Office Scan’ is responsible for blocking USB Thumb Drive Access. There’s a time limit to unblock this. At the beginning after restarting the PC:</p>

<ol>
  <li>Quickly login.</li>
  <li>Quickly go to services (you may type ‘services’ in search bar).</li>
  <li>Disable TMBMServer shown on Figure 6.</li>
  <li>Now data transfer is possible as shown on Figure 7.</li>
  <li>To disable password, edit the registry.</li>
  <li>Edit the value of ‘NoPwdProtect’ at ‘HKEY_LOCAL_MACHINE\SOFTWARE\ TrendMicro\PC-cillinNTCorp\CurrentVersion\Misc.’ from ‘0’ to ‘1’.</li>
  <li>There is also ‘Allow Uninstall’ and you may edit.</li>
  <li>Figure 8 shows Micro Trend Office Agent unlocked.</li>
</ol>

<p>This method is one at a time use only. I meant that you have to repeat these steps again if you reboot your PC. Further action needed if you want to maintain the access which will be explained at the next section.</p>

<p><img src="https://farm6.staticflickr.com/5701/21186678978_5c56b88ae0_o_d.png" alt="Unable to perform data transfer using flash disk" /></p>

<p>Figure 5. Unable to perform data transfer using flash disk</p>

<p><img src="https://farm1.staticflickr.com/639/21186437430_75e54e5bd6_o_d.png" alt="Disabling Trend Micro Unauthorized change" /></p>

<p>Figure 6. Disabling Trend Micro Unauthorized change</p>

<p><img src="https://farm6.staticflickr.com/5754/21187638829_08bc335352_o_d.png" alt="Able to perform data transfer using flash disk" /></p>

<p>Figure 7. Able to perform data transfer using flash disk</p>

<p><img src="https://farm1.staticflickr.com/733/21363745242_b5a3e95982_o_d.png" alt="Unlock office scan agent" /></p>

<p>Figure 8. Unlock office scan agent</p>

<div class="video-container"><iframe src="https://www.youtube.com/embed/OGkWyzfLkm8" frameborder="0" allowfullscreen=""></iframe></div>

<h2 id="4-maintaining-access">4. Maintaining Access</h2>

<p>The maintaining access here means that the steps on Section 3 don’t have to be repeated the next time we boot the PC. Instead we will configure for the steps above to run at startup, to do that we need to know the command line base of the above methods. Code 1 contains a simple command to replace ‘sethc.exe’ with ‘cmd.exe’. Code 2 contains commands to stop and disable Trend Micro Unauthorized Change Service, followed by editing ‘NoPwdProtect’ key registry.</p>

<table><caption>Code 1\. Replace-sethc-with-cmd.bat</caption>

<tbody>

<tr>

<th style="color: green; background-color:black;">`

<pre>copy C:\Windows\System32\cmd.exe C:\Windows\System32\sethc.exe pause</pre>

`</th>

</tr>

</tbody>

</table>

<table><caption>Code 2\. Disable-Micro-Trend-Office-Scan.bat</caption>

<tbody>

<tr>

<th style="color: green; background-color:black;">`

<pre>		sc stop TMBMServer
			sc config TMBMServer start= disabled
			reg add HKEY_LOCAL_MACHINE\SOFTWARE\TrendMicro\PC-cillinNTCorp\CurrentVersion\Misc. /v NoPwdProtect /t REG_DWORD /d 1 /f
</pre>

`</th>

</tr>

</tbody>

</table>

<p>The following can be done in ‘computer management’ to add startups:</p>

<ol>
  <li>Open Computer Management (type in search bar), pick the option task scheduler, and then choose create task.</li>
  <li>On the General Menu it’s up to you to set but we recommend to tick ‘run with highest privilege’.</li>
  <li>On the Trigger Menu we can choose whether to run at startup, after login, both of them, or custom use.</li>
  <li>Finally in Action Menu is where the script is inserted, insert Code 1 and Code 2 one at a time. You can refer to the bat file, but sometimes running bat files is blocked. Another option is to insert the command itself (not the script file / bat file) which is more promising.</li>
  <li>Other menu is not needed in this report but feel free in setting to your needs.</li>
  <li>Once it is done 2 tasks should show on the scheduler library as in Figure 9. The next time it boots it should run those 2 tasks.</li>
</ol>

<p><img src="https://farm1.staticflickr.com/664/21186946300_1224bb3a56_o_d.png" alt="Task Scheduler" /></p>

<p>Figure 9. Task Scheduler</p>

<div class="video-container"><iframe src="https://www.youtube.com/embed/UqB8o_vG_Wk" frameborder="0" allowfullscreen=""></iframe></div>

<h2 id="mirrors">Mirrors</h2>

<ul>
  <li><a href="https://0fajarpurnama0.github.io/misc/2020/03/11/hacking-office-trend-usb-windows.html">https://0fajarpurnama0.github.io/misc/2020/03/11/hacking-office-trend-usb-windows.html</a></li>
  <li><a href="https://medium.com/@0fajarpurnama0/hacking-sethc-and-office-trend-usb-windows-7-938a78c5f9ca">https://medium.com/@0fajarpurnama0/hacking-sethc-and-office-trend-usb-windows-7-938a78c5f9ca</a></li>
  <li><a href="https://hicc.cs.kumamoto-u.ac.jp/~fajar/tmp/hacking-office-trend-usb-windows.html">https://hicc.cs.kumamoto-u.ac.jp/~fajar/tmp/hacking-office-trend-usb-windows.html</a></li>
  <li><a href="https://0darkking0.blogspot.com/2020/03/hacking-office-trend-usb-windows.html">https://0darkking0.blogspot.com/2020/03/hacking-office-trend-usb-windows.html</a></li>
  <li><a href="http://0fajarpurnama0.weebly.com/blog/hacking-office-trend-usb-windows-7-when-you-have-physical-access">http://0fajarpurnama0.weebly.com/blog/hacking-office-trend-usb-windows-7-when-you-have-physical-access</a></li>
  <li><a href="https://0fajarpurnama0.wixsite.com/0fajarpurnama0/post/hacking-office-trend-usb-windows-7-when-you-have-physical-access">https://0fajarpurnama0.wixsite.com/0fajarpurnama0/post/hacking-office-trend-usb-windows-7-when-you-have-physical-access</a></li>
  <li><a href="https://0fajarpurnama0.cloudaccess.host/index.php/uncategorised/9-hacking-office-trend-usb-windows-7-when-you-have-physical-access">https://0fajarpurnama0.cloudaccess.host/index.php/uncategorised/9-hacking-office-trend-usb-windows-7-when-you-have-physical-access</a></li>
  <li><a href="https://0fajarpurnama0.tumblr.com/post/612297942824632321/hacking-sethc-and-office-trend-usb-windows-7-when">https://0fajarpurnama0.tumblr.com/post/612297942824632321/hacking-sethc-and-office-trend-usb-windows-7-when</a></li>
  <li><a href="http://www.teiii.cn/hacking-office-trend-usb-windows-7-when-you-have-physical-access">http://www.teiii.cn/hacking-office-trend-usb-windows-7-when-you-have-physical-access</a></li>
</ul>

</div>

	</div>
</div>

	
  </body>

  <footer>

	<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0; float: left;" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-CustomizedShareAlike 4.0 International License</a>. I Fajar Purnama as the creator customized the ShareAlike (sa) license here where you are also allowed to sell my contents but with a condition that you must mention that the free and open version is available here. In summary, the mention must contain the keyword "free" and "open" and the location such as the link to this content.</p>

	<div class="social-media">
		<a href="https://0fajarpurnama0.github.io"><img class="myicon" src="/assets/images/icon/github.png" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/website.png';" alt="cv"/></a>
				
		<a href="https://www.publish0x.com/0fajarpurnama0?a=4oeEw0Yb0B&tid=github"><img class="myicon" src="/assets/images/icon/crypto/publish0x.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/publish0x.png';" alt="publish0x"/></a>
		
		<a href="https://hive.blog/@fajar.purnama?r=fajar.purnama"><img class="myicon" src="/assets/images/icon/crypto/hive.jpg" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/hive.jpg';" alt="hive"/></a>
		
		<a href="https://steemit.com/@fajar.purnama?r=fajar.purnama"><img class="myicon" src="/assets/images/icon/crypto/steemit.png" onerror="this.onerror=null;this.src='https://steemit.com/@fajar.purnama?r=fajar.purnama';" alt="steemit"/></a>
		
		<a href="https://lbry.tv/@0fajarpurnama0:e"><img class="myicon" src="/assets/images/icon/crypto/lbry.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/lbry.png';" alt="https://lbry.tv/$/invite/@0fajarpurnama0:e"/></a>
		
		<a href="https://bittube.tv/profile/0fajarpurnama0"><img class="myicon" src="/assets/images/icon/crypto/bittube.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/bittube.png';" alt="https://bittube.app/?ref?2JY4FE0CP"/></a>
		
		<a href="https://www.youtube.com/c/PurnamaABC"><img class="myicon" src="/assets/images/icon/youtube.png" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/youtube.png';" alt="youtube"/></a>
		
		<a href="https://www.twitch.tv/0fajarpurnama0"><img class="myicon" src="/assets/images/icon/twitch.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/twitch.png';" alt="twitch"/></a>
		
		<a href="https://www.bitchute.com/channel/0fajarpurnama0"><img class="myicon" src="/assets/images/icon/crypto/bitchute.jpg" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/bitchute.jpg';" alt="bitchute"/></a>
		
		<a href="https://dlive.tv/fajarpurnama"><img class="myicon" src="/assets/images/icon/crypto/dlive.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/dlive.png';" alt="dlive"/></a>
		
		<a href="https://d.tube/#!/c/fajar.purnama"><img class="myicon" src="/assets/images/icon/crypto/dtube.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/dtube.png';" alt="dtube"/></a>
		
		<a href="https://twitter.com/0FajarPurnama0"><img class="myicon" src="/assets/images/icon/twitter.png" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/twitter.png';" alt="twitter"/></a>

		<a href="https://www.facebook.com/fajar.purnama.543"><img class="myicon" src="/assets/images/icon/facebook.png" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/facebook.png';" alt="facebook"/></a>

		<a href="https://instagram.com/0fajarpurnama0"><img class="myicon" src="/assets/images/icon/instagram.jpg" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/instagram.jpg';" alt="instagram"/></a>

		<a href="https://www.linkedin.com/in/fajar-purnama-45583780"><img class="myicon" src="/assets/images/icon/linked.jpg" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/linked.jpg';" alt="lindked"/></a>

		<a href="https://discord.gg/aDRAu7Q"><img class="myicon" src="/assets/images/icon/discord.jpg" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/discord.jpg';" alt="discord"/></a>

		<a href="https://www.reddit.com/user/0fajarpurnama0"><img class="myicon" src="/assets/images/icon/reddit.jpg" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/reddit.jpg';" alt="reddit"/></a>

		<a href="https://vk.com/0fajarpurnama0"><img class="myicon" src="/assets/images/icon/vk.png" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/vk.png';" alt="vk"/></a>
		
		<a href="https://id.pinterest.com/fajarpurnamaabc"><img class="myicon" src="/assets/images/icon/pininterest.jpg" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/pininterest.jpg';" alt="pininterest"/></a>
		
		<a href="https://social.eaglerockglobal.org/0fajarpurnama0"><img class="myicon" src="/assets/images/icon/socialeaglerockglobal.png" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/socialeaglerockglobal.png';" alt="socialeaglerockglobal"/></a>
		
		<a href="https://medium.com/@0fajarpurnama0"><img class="myicon" src="/assets/images/icon/medium.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/medium.png';" alt="medium"/></a>
		
		<a href="http://0darkking0.blogspot.com"><img class="myicon" src="/assets/images/icon/blogger.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/blogger.png';" alt="blogger"/></a>
		
		<a href="https://0fajarpurnama0.weebly.com"><img class="myicon" src="/assets/images/icon/weebly.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/weebly.png';" alt="weebly"/></a>
		
		<a href="https://0fajarpurnama0.wixsite.com/0fajarpurnama0"><img class="myicon" src="/assets/images/icon/wix.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/wix.png';" alt="wix"/></a>
		
		<!-- Depricated
		
		<a href="https://0fajarpurnama0.tumblr.com"><img class="myicon" src="/assets/images/icon/tumblr.png" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/tumblr.png';" alt="thumblr"/></a>
		
		<a href="https://0fajarpurnama0.cloudaccess.host"><img class="myicon" src="/assets/images/icon/joomla.jpg" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/joomla.jpg';" alt="joomla"/></a>
		
		<a href="https://www.minds.com/0fajarpurnama0"><img class="myicon" src="/assets/images/icon/crypto/minds.svg" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/minds.svg';" alt="minds"/></a>
		
		<a href="https://hicc.cs.kumamoto-u.ac.jp/~fajar"><img class="myicon" src="/assets/images/icon/website.png" onerror="this.onerror=null;this.src='https://404store.com/2020/02/10/website.png';" alt="portal"/></a>
		
		<a href="https://view.ly/c/9eb285499018ec34"><img class="myicon" src="/assets/images/icon/crypto/viewly.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/viewly.png';" alt="viewly"/></a>
		
		<a href="https://www.uptrennd.com/user/NjYwNjg"><img class="myicon" src="/assets/images/icon/crypto/uptrennd.png" onerror="this.onerror=null;this.src='https://404store.com/2020/03/16/uptrennd.png';" alt="uptrennd"/></a>
		-->
	</div>
  </footer>

</html>
